[{"id":"6dc81ef2.53057","type":"tab","label":"Aqara-Discomfort Index","disabled":false,"info":""},{"id":"8135f213.9128b","type":"tab","label":"Aqara-Temperature","disabled":false,"info":""},{"id":"fc47a2dd.ef4a2","type":"tab","label":"Aqara-zigbee2mqtt","disabled":false,"info":""},{"id":"fa9d6b0d.14f898","type":"tab","label":"Thingsboard","disabled":false,"info":""},{"id":"b0286ed6.293c9","type":"tab","label":"플로우 1","disabled":false,"info":""},{"id":"7263074d.abde28","type":"tab","label":"플로우 2","disabled":false,"info":""},{"id":"2c9f26f8.cfc3ca","type":"tab","label":"플로우 3","disabled":false,"info":""},{"id":"2b05d3b7.79e00c","type":"mqtt-broker","name":"Thingsboard MQTT Broker","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"2","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"3b32493.46db1b6","type":"mqtt-broker","name":"Home MQTT Broker","broker":"127.0.0.1","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"f861f58f.b08408","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"3e0fc4f1.e10a2c","type":"ui_tab","name":"Aqara Database","icon":"dashboard","disabled":false,"hidden":false},{"id":"5723a8a8.56a7e8","type":"ui_tab","name":"MySQL Database","icon":"dashboard","disabled":false,"hidden":false},{"id":"d92b6e34.42bb2","type":"ui_group","name":"Aqara 온습도 센서-게이지","tab":"3e0fc4f1.e10a2c","order":1,"disp":true,"width":"18","collapse":false},{"id":"9fab055d.a70e68","type":"ui_group","name":"Aqara 온습도 센서- 평균온습도","tab":"3e0fc4f1.e10a2c","order":2,"disp":true,"width":"16","collapse":true},{"id":"9c80a61b.796368","type":"ui_group","name":"Aqara 온습도 센서 - 라인차트","tab":"3e0fc4f1.e10a2c","order":3,"disp":true,"width":"18","collapse":false},{"id":"9875e92d.006a68","type":"ui_group","name":"MySQLDB","tab":"5723a8a8.56a7e8","order":1,"disp":true,"width":"16","collapse":false},{"id":"e8232f64.a1d1e","type":"MySQLdatabase","name":"","host":"142.93.75.207","port":"3306","db":"iot","tz":"","charset":""},{"id":"92b93824.117328","type":"MySQLdatabase","host":"192.168.219.106","port":"3306","db":"iot","tz":""},{"id":"cb216faf.d9136","type":"mqtt-broker","name":"","broker":"iot.eclipse.org","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"443e25cb.f12b4c","type":"mqtt in","z":"8135f213.9128b","name":"MQTT with MySQL ","topic":"thpDummy","qos":"2","datatype":"auto","broker":"2b05d3b7.79e00c","x":110,"y":200,"wires":[["82612d46.2188b"]]},{"id":"648eec3e.19d124","type":"function","z":"8135f213.9128b","name":"AQARA Parsing","func":"vtopic = {};\nvtemperature = {};\nvhumidity = {};\nvpressure = {};\n\nvtopic.payload = msg.topic;\nvtemperature.payload = msg.payload.temperature;\nvhumidity.payload = msg.payload.humidity;\nvpressure.payload = msg.payload.pressure;\n\nvar query = \"INSERT INTO thpTable (topic, temperature,humidity,pressure) VALUES ('\" + vtopic.payload + \"','\" + vtemperature.payload + \"','\" + vhumidity.payload + \"','\" + vpressure.payload + \"')\"; \n\nmsg.topic = query;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":320,"y":320,"wires":[["a8e8589c.66ed08"]]},{"id":"82612d46.2188b","type":"json","z":"8135f213.9128b","name":"MQTT Parsing","property":"payload","action":"","pretty":false,"x":290,"y":260,"wires":[["648eec3e.19d124"]]},{"id":"3c8ed82c.d2e258","type":"function","z":"8135f213.9128b","name":"Graph Parsing","func":"\nmsg1 = {};\nmsg2 = {};\nmsg3 = {};\n\n\nmsg1.payload = msg.payload.temperature;\nmsg2.payload = msg.payload.humidity;\nmsg3.payload = msg.payload.pressure;\n\nreturn [msg1,msg2,msg3];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":420,"y":100,"wires":[[],[],[]],"outputLabels":["msg1","msg2","msg3"]},{"id":"e4cf7e28.c22e1","type":"mqtt in","z":"8135f213.9128b","name":"MQTT with Charts","topic":"thpDummy","qos":"2","datatype":"auto","broker":"2b05d3b7.79e00c","x":120,"y":80,"wires":[["247c421a.1e955e"]]},{"id":"247c421a.1e955e","type":"json","z":"8135f213.9128b","name":"Parsing for Charts","property":"payload","action":"","pretty":false,"x":320,"y":160,"wires":[["3c8ed82c.d2e258"]]},{"id":"edccafc5.58ec3","type":"inject","z":"8135f213.9128b","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":440,"wires":[["8ba444af.4e1648"]]},{"id":"8ba444af.4e1648","type":"function","z":"8135f213.9128b","name":"Read from MySQL","func":"var out = \"select timestamp,temperature, humidity from thpTable ORDER BY id DESC LIMIT 1\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":210,"y":560,"wires":[["3104584f.c86158"]]},{"id":"afe3422a.d6243","type":"file","z":"8135f213.9128b","name":"Aqara Temperature Monintoring","filename":"cgv.txt","appendNewline":true,"createDir":true,"overwriteFile":"false","x":510,"y":580,"wires":[[]]},{"id":"bfdec137.73ccb","type":"function","z":"8135f213.9128b","name":"Charts from DB","func":"msg1 = {};\nmsg2 = {};\n\nmsg1.payload = msg.payload[0].temperature;\nmsg2.payload = msg.payload[0].humidity;\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","x":580,"y":520,"wires":[[],[]],"outputLabels":["msg1","msg2"]},{"id":"2143066e.59a65a","type":"inject","z":"8135f213.9128b","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":230,"y":660,"wires":[["7ce279e9.35cae8"]]},{"id":"7ce279e9.35cae8","type":"function","z":"8135f213.9128b","name":"Read from MyS","func":"\nvar out = \"select AVG(temperature), AVG(humidity) from thpTable\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":780,"wires":[["a9f86d42.197a8"]]},{"id":"4f237fdf.efe91","type":"function","z":"8135f213.9128b","name":"Average Temperature & Humidity","func":"msg1 = {};\nmsg2 = {};\nmsg1.payload = msg.payload[0][\"AVG(temperature)\"];\nmsg2.payload = msg.payload[0][\"AVG(humidity)\"];\nmsg1.payload = msg1.payload.toFixed(2);\nmsg2.payload = msg2.payload.toFixed(2);\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","x":840,"y":720,"wires":[[],[]],"outputLabels":["msg1","msg2"]},{"id":"564fd50.9d01c2c","type":"debug","z":"8135f213.9128b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":650,"y":900,"wires":[]},{"id":"a8e8589c.66ed08","type":"mysql","z":"8135f213.9128b","mydb":"e8232f64.a1d1e","name":"MySQL","x":490,"y":360,"wires":[[]]},{"id":"3104584f.c86158","type":"mysql","z":"8135f213.9128b","mydb":"e8232f64.a1d1e","name":"MySQL","x":420,"y":460,"wires":[["afe3422a.d6243","bfdec137.73ccb"]]},{"id":"a9f86d42.197a8","type":"mysql","z":"8135f213.9128b","mydb":"e8232f64.a1d1e","name":"MySQL","x":560,"y":780,"wires":[["4f237fdf.efe91","564fd50.9d01c2c"]]},{"id":"ac1ea6a4.50e958","type":"mqtt in","z":"fc47a2dd.ef4a2","name":"MQTT with MySQL ","topic":"zigbee2mqtt/aqarathp","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":90,"y":280,"wires":[["d4139a7d.bf3378"]]},{"id":"46c4ea2d.f4c7b4","type":"function","z":"fc47a2dd.ef4a2","name":"AQARA Parsing","func":"vtopic = {};\nvtemperature = {};\nvhumidity = {};\nvpressure = {};\n\nvtopic.payload = msg.topic;\nvtemperature.payload = msg.payload.temperature;\nvhumidity.payload = msg.payload.humidity;\nvpressure.payload = msg.payload.pressure;\n\nvar query = \"INSERT INTO thpTable (topic, temperature,humidity,pressure) VALUES ('\" + vtopic.payload + \"','\" + vtemperature.payload + \"','\" + vhumidity.payload + \"','\" + vpressure.payload + \"')\"; \n\nmsg.topic = query;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":300,"y":380,"wires":[["dca8cbd8.5ba0b8"]]},{"id":"d4139a7d.bf3378","type":"json","z":"fc47a2dd.ef4a2","name":"MQTT Parsing","property":"payload","action":"","pretty":false,"x":300,"y":320,"wires":[["46c4ea2d.f4c7b4"]]},{"id":"99a16c17.5308c","type":"function","z":"fc47a2dd.ef4a2","name":"Graph Parsing","func":"\nmsg1 = {};\nmsg2 = {};\nmsg3 = {};\n\n\nmsg1.payload = msg.payload.temperature;\nmsg2.payload = msg.payload.humidity;\nmsg3.payload = msg.payload.pressure;\n\nreturn [msg1,msg2,msg3];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":420,"y":100,"wires":[[],[],[]],"outputLabels":["msg1","msg2","msg3"]},{"id":"28e6e9f.76eda16","type":"mqtt in","z":"fc47a2dd.ef4a2","name":"MQTT with Charts","topic":"zigbee2mqtt/aqarathp","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":120,"y":80,"wires":[["86552e3b.6e6d1"]]},{"id":"86552e3b.6e6d1","type":"json","z":"fc47a2dd.ef4a2","name":"Parsing for Charts","property":"payload","action":"","pretty":false,"x":320,"y":160,"wires":[["99a16c17.5308c","e139a206.3bae2"]]},{"id":"97b94227.2cc85","type":"inject","z":"fc47a2dd.ef4a2","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":440,"wires":[["5c649e9b.b59"]]},{"id":"5c649e9b.b59","type":"function","z":"fc47a2dd.ef4a2","name":"Read from MySQL","func":"var out = \"select timestamp,temperature, humidity from thpTable ORDER BY id DESC LIMIT 1\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":210,"y":560,"wires":[["f3968871.baa0c8"]]},{"id":"4f2a810a.9f461","type":"file","z":"fc47a2dd.ef4a2","name":"Aqara Temperature Monintoring","filename":"aqara.txt","appendNewline":true,"createDir":true,"overwriteFile":"false","x":510,"y":580,"wires":[[]]},{"id":"db888d91.b1aed","type":"function","z":"fc47a2dd.ef4a2","name":"Charts from DB","func":"msg1 = {};\nmsg2 = {};\n\nmsg1.payload = msg.payload[0].temperature;\nmsg2.payload = msg.payload[0].humidity;\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","x":580,"y":520,"wires":[[],[]],"outputLabels":["msg1","msg2"]},{"id":"3b0e0b60.1d8d34","type":"inject","z":"fc47a2dd.ef4a2","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":230,"y":660,"wires":[["72ccc125.21a28"]]},{"id":"72ccc125.21a28","type":"function","z":"fc47a2dd.ef4a2","name":"Read from MyS","func":"\nvar out = \"select AVG(temperature), AVG(humidity) from thpTable\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":780,"wires":[["535578f9.830468"]]},{"id":"da1eed27.dde85","type":"function","z":"fc47a2dd.ef4a2","name":"Average Temperature & Humidity","func":"msg1 = {};\nmsg2 = {};\nmsg1.payload = msg.payload[0][\"AVG(temperature)\"];\nmsg2.payload = msg.payload[0][\"AVG(humidity)\"];\nmsg1.payload = msg1.payload.toFixed(2);\nmsg2.payload = msg2.payload.toFixed(2);\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"x":840,"y":720,"wires":[[],[]],"outputLabels":["msg1","msg2"]},{"id":"c53946dc.1143b8","type":"debug","z":"fc47a2dd.ef4a2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":650,"y":900,"wires":[]},{"id":"dca8cbd8.5ba0b8","type":"mysql","z":"fc47a2dd.ef4a2","mydb":"e8232f64.a1d1e","name":"MySQL","x":500,"y":380,"wires":[["72f5304.edffcd"]]},{"id":"f3968871.baa0c8","type":"mysql","z":"fc47a2dd.ef4a2","mydb":"e8232f64.a1d1e","name":"MySQL","x":420,"y":460,"wires":[["4f2a810a.9f461","db888d91.b1aed"]]},{"id":"535578f9.830468","type":"mysql","z":"fc47a2dd.ef4a2","mydb":"e8232f64.a1d1e","name":"MySQL","x":560,"y":780,"wires":[["da1eed27.dde85","c53946dc.1143b8"]]},{"id":"e139a206.3bae2","type":"debug","z":"fc47a2dd.ef4a2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":430,"y":220,"wires":[]},{"id":"1ecddb06.f037c5","type":"mqtt out","z":"b0286ed6.293c9","name":"","topic":"test","qos":"","retain":"","broker":"3b32493.46db1b6","x":310,"y":140,"wires":[]},{"id":"ecef9ad7.502338","type":"inject","z":"b0286ed6.293c9","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"test","payload":"30","payloadType":"num","x":90,"y":160,"wires":[["1ecddb06.f037c5"]]},{"id":"aa0cd7ea.cdf978","type":"mqtt in","z":"b0286ed6.293c9","name":"","topic":"test","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":200,"y":260,"wires":[[]]},{"id":"1e8f6f21.2ca7e1","type":"mqtt in","z":"fa9d6b0d.14f898","name":"MQTT with MySQL ","topic":"zigbee2mqtt/aqarathp","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":90,"y":280,"wires":[["15714048.a0fe"]]},{"id":"28250399.46c66c","type":"function","z":"fa9d6b0d.14f898","name":"AQARA Parsing","func":"vtopic = {};\nvtemperature = {};\nvhumidity = {};\nvpressure = {};\n\nvtopic.payload = msg.topic;\nvtemperature.payload = msg.payload.temperature;\nvhumidity.payload = msg.payload.humidity;\nvpressure.payload = msg.payload.pressure;\n\nvar query = \"INSERT INTO thpTable (topic, temperature,humidity,pressure) VALUES ('\" + vtopic.payload + \"','\" + vtemperature.payload + \"','\" + vhumidity.payload + \"','\" + vpressure.payload + \"')\"; \n\nmsg.topic = query;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":300,"y":380,"wires":[[]]},{"id":"15714048.a0fe","type":"json","z":"fa9d6b0d.14f898","name":"MQTT Parsing","property":"payload.temperature","action":"","pretty":true,"x":300,"y":320,"wires":[["28250399.46c66c","a6e1a4ee.069da8","466b1d44.cc1004"]]},{"id":"a6e1a4ee.069da8","type":"debug","z":"fa9d6b0d.14f898","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":580,"y":280,"wires":[]},{"id":"466b1d44.cc1004","type":"mqtt out","z":"fa9d6b0d.14f898","name":"Thingsboard","topic":"KmK0Viu77Geuf76E0aDg","qos":"","retain":"","broker":"2b05d3b7.79e00c","x":800,"y":380,"wires":[]},{"id":"da8ca300.2dfe6","type":"create dataset","z":"7263074d.abde28","name":"","path":"test/iris.data","saveFolder":"test/datasets","saveName":"iris","input":"0,1,2,3","output":"4","trainingPartition":"","shuffle":true,"seed":"","x":340,"y":260,"wires":[["4fb0a8dc.f6baf8"]]},{"id":"44b6f4b0.34d7dc","type":"load dataset","z":"7263074d.abde28","name":"","datasetFolder":"test/datasets","datasetName":"iris","partition":"train.csv","input":true,"output":true,"x":290,"y":380,"wires":[["26110acb.cbf526"],["86385870.9f6b88"]]},{"id":"4f7cc53d.87a22c","type":"inject","z":"7263074d.abde28","name":"start","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":260,"wires":[["da8ca300.2dfe6"]]},{"id":"d3e9e7ab.a06d68","type":"inject","z":"7263074d.abde28","name":"start","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":380,"wires":[["44b6f4b0.34d7dc"]]},{"id":"b21982e2.99cf1","type":"inject","z":"7263074d.abde28","name":"start","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":110,"y":620,"wires":[["f1b47338.aab82","1ea9f445.89d0bc"]]},{"id":"4fb0a8dc.f6baf8","type":"debug","z":"7263074d.abde28","name":"print","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":570,"y":260,"wires":[]},{"id":"86385870.9f6b88","type":"debug","z":"7263074d.abde28","name":"error","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":770,"y":420,"wires":[]},{"id":"2270c854.c34e08","type":"debug","z":"7263074d.abde28","name":"print","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":750,"y":340,"wires":[]},{"id":"e69a3271.c7cab","type":"predictor","z":"7263074d.abde28","name":"decision tree classifier predictor","modelPath":"test/models","modelName":"dtc.b","x":550,"y":600,"wires":[["b8f2ab19.e693a8"],["f7c59de2.be773"]]},{"id":"26110acb.cbf526","type":"decision tree classifier","z":"7263074d.abde28","name":"decision tree classifier trainer","savePath":"test/models","saveName":"dtc.b","maxDepth":"","criterion":"gini","splitter":"best","x":540,"y":380,"wires":[["2270c854.c34e08"],["86385870.9f6b88"]]},{"id":"b8f2ab19.e693a8","type":"assessment","z":"7263074d.abde28","name":"","score":"accuracy_score","x":590,"y":540,"wires":[["808a0c93.8ee38"],["f7c59de2.be773"]]},{"id":"f1b47338.aab82","type":"load dataset","z":"7263074d.abde28","name":"","datasetFolder":"test/datasets","datasetName":"iris","partition":"test.csv","input":false,"output":true,"x":290,"y":540,"wires":[["b8f2ab19.e693a8"],["f7c59de2.be773"]]},{"id":"1ea9f445.89d0bc","type":"load dataset","z":"7263074d.abde28","name":"","datasetFolder":"test/datasets","datasetName":"iris","partition":"test.csv","input":true,"output":false,"x":290,"y":660,"wires":[["e69a3271.c7cab"],["f7c59de2.be773"]]},{"id":"f7c59de2.be773","type":"debug","z":"7263074d.abde28","name":"error","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":790,"y":660,"wires":[]},{"id":"808a0c93.8ee38","type":"debug","z":"7263074d.abde28","name":"print","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":790,"y":540,"wires":[]},{"id":"8a4ea95c.f860b8","type":"predictor","z":"7263074d.abde28","name":"decision tree classifier predictor","modelPath":"test/models","modelName":"dtc.b","x":450,"y":760,"wires":[["e967043f.480868"],["e66df10b.40ba8"]]},{"id":"e967043f.480868","type":"mqtt out","z":"7263074d.abde28","name":"","topic":"predictions","qos":"","retain":"","broker":"cb216faf.d9136","x":730,"y":720,"wires":[]},{"id":"e66df10b.40ba8","type":"debug","z":"7263074d.abde28","name":"error","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":710,"y":800,"wires":[]},{"id":"3cd1a442.2bc73c","type":"mqtt in","z":"7263074d.abde28","name":"","topic":"classification","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":140,"y":760,"wires":[["8a4ea95c.f860b8"]]},{"id":"56be7587.47cbbc","type":"mqtt in","z":"6dc81ef2.53057","name":"MQTT with MySQL ","topic":"zigbee2mqtt/aqarathp","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":90,"y":280,"wires":[["c9997a84.c5b4a8"]]},{"id":"dd60edcc.4fd53","type":"function","z":"6dc81ef2.53057","name":"AQARA Parsing","func":"vtopic = {};\nvtemperature = {};\nvhumidity = {};\nvpressure = {};\nvdiscomfort = {};\nvdiscomfortIndex = {};\n\nvtopic.payload = msg.topic;\nvtemperature.payload = msg.payload.temperature;\nvhumidity.payload = msg.payload.humidity;\nvpressure.payload = msg.payload.pressure;\nvdiscomfort.payload = 1.8*vtemperature.payload-0.55*(1-(vhumidity.payload/100))*(1.8*vtemperature.payload-26)+32;\n\nif (vdiscomfort.payload < 76 ){\n    vdiscomfortIndex.payload =\"low\";\n} else if (vdiscomfort.payload >=76 && vdiscomfort.payload <80){\n    vdiscomfortIndex.payload = \"mid\";\n} else if (vdiscomfort.payload >= 80){\n    vdiscomfortIndex.payload = \"high\";\n}\n\n\nvar query = \"INSERT INTO discomfortTable (topic, discomfort, discomfortindex, temperature,humidity,pressure) VALUES ('\" + vtopic.payload + \"','\" + vdiscomfortIndex.payload + \"','\" + vdiscomfort.payload + \"','\" + vtemperature.payload + \"','\" + vhumidity.payload + \"','\" + vpressure.payload + \"')\"; \n\nmsg.topic = query;\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":300,"y":380,"wires":[["7e377ba.664f284"]]},{"id":"c9997a84.c5b4a8","type":"json","z":"6dc81ef2.53057","name":"MQTT Parsing","property":"payload","action":"","pretty":false,"x":300,"y":320,"wires":[["dd60edcc.4fd53"]]},{"id":"ff164fd7.e08f5","type":"function","z":"6dc81ef2.53057","name":"Graph Parsing","func":"\nmsg1 = {};\nmsg2 = {};\nmsg3 = {};\n\n\nmsg1.payload = msg.payload.temperature;\nmsg2.payload = msg.payload.humidity;\nmsg3.payload = msg.payload.pressure;\n\nreturn [msg1,msg2,msg3];","outputs":3,"noerr":0,"initialize":"","finalize":"","x":420,"y":100,"wires":[["bcb4df78.db706"],["7eaa9fdb.b76f7"],["2f850420.965bcc"]],"outputLabels":["msg1","msg2","msg3"]},{"id":"5dd1d8d7.601c18","type":"mqtt in","z":"6dc81ef2.53057","name":"MQTT with Charts","topic":"zigbee2mqtt/aqarathp","qos":"2","datatype":"auto","broker":"3b32493.46db1b6","x":120,"y":80,"wires":[["bdc3443e.4b4148","c69f0dd6.649e5"]]},{"id":"bdc3443e.4b4148","type":"json","z":"6dc81ef2.53057","name":"Parsing for Charts","property":"payload","action":"","pretty":false,"x":320,"y":160,"wires":[["ff164fd7.e08f5","c807f0b5.cc03c"]]},{"id":"49c14354.5d9dec","type":"inject","z":"6dc81ef2.53057","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":130,"y":440,"wires":[["492a677b.070998"]]},{"id":"492a677b.070998","type":"function","z":"6dc81ef2.53057","name":"Read from MySQL","func":"var out = \"select timestamp,temperature, humidity from discomfortTable ORDER BY id DESC LIMIT 1\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":210,"y":560,"wires":[["6719d51d.b0366c"]]},{"id":"59718eb3.dbe46","type":"file","z":"6dc81ef2.53057","name":"Aqara Temperature Monintoring","filename":"aqara.txt","appendNewline":true,"createDir":true,"overwriteFile":"false","x":510,"y":580,"wires":[[]]},{"id":"27e61c70.541514","type":"function","z":"6dc81ef2.53057","name":"Charts from DB","func":"msg1 = {};\nmsg2 = {};\n\nmsg1.payload = msg.payload[0].temperature;\nmsg2.payload = msg.payload[0].humidity;\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","x":580,"y":520,"wires":[["35257d31.b994c2"],["ee717e4b.5e30f"]],"outputLabels":["msg1","msg2"]},{"id":"b385eec.54ae81","type":"inject","z":"6dc81ef2.53057","name":"Report Generator","repeat":"10","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":230,"y":660,"wires":[["fac26bac.3dbc18"]]},{"id":"fac26bac.3dbc18","type":"function","z":"6dc81ef2.53057","name":"Read from MyS","func":"\nvar out = \"select AVG(temperature), AVG(humidity) from discomfortTable\";\nmsg.topic = out;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":340,"y":780,"wires":[["f5d4692a.682368"]]},{"id":"f1a2dfe.b1a6c2","type":"function","z":"6dc81ef2.53057","name":"Average Temperature & Humidity","func":"msg1 = {};\nmsg2 = {};\nmsg1.payload = msg.payload[0][\"AVG(temperature)\"];\nmsg2.payload = msg.payload[0][\"AVG(humidity)\"];\nmsg1.payload = msg1.payload.toFixed(2);\nmsg2.payload = msg2.payload.toFixed(2);\n\nreturn [msg1,msg2];","outputs":2,"noerr":0,"initialize":"","finalize":"","x":840,"y":720,"wires":[["53a04124.2920e"],["fef237a7.f30d58"]],"outputLabels":["msg1","msg2"]},{"id":"2f7dc9b6.1c6c46","type":"debug","z":"6dc81ef2.53057","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","x":650,"y":900,"wires":[]},{"id":"2f850420.965bcc","type":"ui_gauge","z":"6dc81ef2.53057","name":"","group":"d92b6e34.42bb2","order":3,"width":"6","height":"6","gtype":"gage","title":"Pressure","label":"atm","format":"{{value}}","min":"800","max":"2000","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":630,"y":240,"wires":[]},{"id":"bcb4df78.db706","type":"ui_gauge","z":"6dc81ef2.53057","name":"Temperature","group":"d92b6e34.42bb2","order":1,"width":"6","height":"6","gtype":"gage","title":"Temperature","label":"C","format":"{{value}}","min":0,"max":"40","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":630,"y":60,"wires":[]},{"id":"7eaa9fdb.b76f7","type":"ui_gauge","z":"6dc81ef2.53057","name":"Humidity","group":"d92b6e34.42bb2","order":2,"width":"6","height":"6","gtype":"gage","title":"Humidity","label":"%","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":640,"y":180,"wires":[]},{"id":"53a04124.2920e","type":"ui_gauge","z":"6dc81ef2.53057","name":"Average Temperature","group":"9fab055d.a70e68","order":1,"width":"8","height":"8","gtype":"compass","title":"Average Temperature","label":"C","format":"{{value}}","min":0,"max":"40","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":970,"y":660,"wires":[]},{"id":"fef237a7.f30d58","type":"ui_gauge","z":"6dc81ef2.53057","name":"Average Humidity","group":"9fab055d.a70e68","order":2,"width":"8","height":"8","gtype":"wave","title":"Average Humidity","label":"%","format":"{{value}}","min":0,"max":"100","colors":["#00b500","#e6e600","#ca3838"],"seg1":"","seg2":"","x":980,"y":780,"wires":[]},{"id":"35257d31.b994c2","type":"ui_chart","z":"6dc81ef2.53057","name":"Temperature","group":"9c80a61b.796368","order":1,"width":"18","height":"9","label":"Temperature","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"Temperature","dot":false,"ymin":"0","ymax":"40","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":770,"y":420,"wires":[[]]},{"id":"ee717e4b.5e30f","type":"ui_chart","z":"6dc81ef2.53057","name":"","group":"9c80a61b.796368","order":2,"width":"18","height":"9","label":"Humidity","chartType":"line","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"100","removeOlder":"24","removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":800,"y":520,"wires":[[]]},{"id":"7e377ba.664f284","type":"mysql","z":"6dc81ef2.53057","mydb":"e8232f64.a1d1e","name":"MySQL","x":500,"y":380,"wires":[[]]},{"id":"6719d51d.b0366c","type":"mysql","z":"6dc81ef2.53057","mydb":"e8232f64.a1d1e","name":"MySQL","x":420,"y":460,"wires":[["59718eb3.dbe46","27e61c70.541514"]]},{"id":"f5d4692a.682368","type":"mysql","z":"6dc81ef2.53057","mydb":"e8232f64.a1d1e","name":"MySQL","x":560,"y":780,"wires":[["f1a2dfe.b1a6c2","2f7dc9b6.1c6c46"]]},{"id":"c807f0b5.cc03c","type":"debug","z":"6dc81ef2.53057","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":430,"y":220,"wires":[]},{"id":"7332af8b.070038","type":"http request","z":"8135f213.9128b","name":"","method":"GET","ret":"txt","paytoqs":"ignore","url":"http://192.168.219.102/temp","tls":"","persist":false,"proxy":"","authType":"","x":1160,"y":140,"wires":[["2b307d9e.46fbda"]]},{"id":"2b307d9e.46fbda","type":"debug","z":"8135f213.9128b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1200,"y":320,"wires":[]},{"id":"c18fd4.8135f83","type":"inject","z":"8135f213.9128b","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":160,"wires":[["7332af8b.070038"]]},{"id":"da8a1954.7946f8","type":"http in","z":"2c9f26f8.cfc3ca","name":"","url":"aqaratemp","method":"get","upload":false,"swaggerDoc":"","x":290,"y":240,"wires":[["56fed39d.44736c"]]},{"id":"65de291e.96dd08","type":"http response","z":"2c9f26f8.cfc3ca","name":"","statusCode":"","headers":{},"x":780,"y":240,"wires":[]},{"id":"56fed39d.44736c","type":"template","z":"2c9f26f8.cfc3ca","name":"","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n<head>\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n<style>\n* {\n  box-sizing: border-box;\n}\n\n/* Create three unequal columns that floats next to each other */\n.column {\n  float: left;\n  padding: 10px;\n  height: 500px; /* Should be removed. Only for demonstration */\n}\n\n.left, .right {\n  width: 33.33%;\n}\n\n.middle {\n  width: 33.33%;\n}\n\n/* Clear floats after the columns */\n.row:after {\n  content: \"\";\n  display: table;\n  clear: both;\n}\n</style>\n</head>\n<body>\n\n<h2>Aqara Temperature-Humidity Mini Dashboard</h2>\n\n<div class=\"row\">\n  <div class=\"column left\" style=\"background-color:#aaa;\">\n    <iframe width=\"100%\" height=\"380px\" frameborder=\"0\" scrolling=\"no\" src=\"http://192.168.219.102/aqara/RGraph/demos/rgraph-ajax-temp-r.php\"\"></iframe>\n  </div>\n  <div class=\"column middle\" style=\"background-color:#bbb;\">\n    <iframe width=\"100%\" height=\"380px\" frameborder=\"0\" scrolling=\"no\" src=\"http://192.168.219.102/aqara/RGraph/demos/rgraph-ajax-hum.php\"></iframe>\n  </div>\n  <div class=\"column right\" style=\"background-color:#ccc;\">\n     <iframe width=\"100%\" height=\"380px\" frameborder=\"0\" scrolling=\"no\" src=\"http://192.168.219.102/aqara/RGraph/demos/rgraph-ajax-pres.php\"\"></iframe>\n  </div>\n</div>\n\n</body>\n</html>\n","output":"str","x":560,"y":260,"wires":[["65de291e.96dd08"]]},{"id":"72f5304.edffcd","type":"debug","z":"fc47a2dd.ef4a2","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":680,"y":380,"wires":[]},{"id":"c69f0dd6.649e5","type":"debug","z":"6dc81ef2.53057","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":330,"y":40,"wires":[]}]